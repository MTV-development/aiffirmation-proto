{
  "id": "26y",
  "title": "Update server action to format conversation for templates",
  "description": "## Objective\n\nModify the `buildChipPrompt` function in server actions to format the conversation history as natural Q\u0026A instead of extracting individual variables.\n\n## Spec Reference\n\n**Spec:** `docs/projects/2026-02-09-fo-10/2026-02-09-fo-10-spec.md` — Section: \"Chip Generation Agent\"\n\n## Scope\n\n**Files to modify:**\n- `app/fo-10/actions.ts` — `buildChipPrompt` function\n\n**Key change:** Instead of extracting `goal`, `why_it_matters`, `situation` variables, format the full exchanges array as \"Q: ... A: ...\" strings and pass to template.\n\n## Implementation\n\n1. Modify `buildChipPrompt` to:\n   - Loop through `context.exchanges` and format as \"Q: {question}\\nA: {answer}\"\n   - Get the NEXT question from `FO10_QUESTIONS[stepNumber - 4]` (step 5 uses question index 1)\n   - Pass these as `conversation_history` and `next_question` variables to template\n2. Remove the individual variable extraction (`goal`, `why_it_matters`, `situation`)\n3. Templates now receive full conversation in natural format\n\n## Tests\n\n1. TypeScript compilation: `npx tsc --noEmit` passes\n2. Manual test: Start dev server, navigate to /fo-10, verify chips appear at steps 5-7\n3. Check dev logs show conversational format in prompts\n\nDo NOT close until acceptance criteria pass.",
  "status": "closed",
  "priority": 2,
  "type": "task",
  "owner": "morten@elk.dk",
  "blocked_by": [
    "vcg"
  ],
  "parent": "x15",
  "acceptance_criteria": "npx tsc --noEmit passes and dev logs show Q\u0026A format",
  "created_by": "morten@elk.dk",
  "created_at": "2026-02-09T10:31:33.370172Z",
  "updated_at": "2026-02-09T10:49:22.377491Z",
  "closed_at": "2026-02-09T10:49:22.377491Z",
  "closed_reason": "Updated buildChipPrompt to format conversation as natural Q\u0026A (Q: ... A: ...) instead of extracting individual variables. Now passes conversation_history and next_question to templates. Updated seed file templates and reseeded database. TypeScript compilation passes."
}