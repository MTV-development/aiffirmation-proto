# FO-05 Specification

**Created:** 2026-01-25
**Status:** Ready

## Overview

FO-05 is an independent implementation (separate agents, UI components, routes) building on the learnings from FO-04. The core flow remains the same, but with two key improvements:

1. **Better agent context** - Include both question and answer in agent calls to enable more varied reflective statements
2. **Sentence fragment inspiration** - Replace single-word chips with half-finished sentences that lower the barrier to writing

## Detailed Design

### Investigation Screen UI

**Initial State:**
- Text input field (prominent, top of interaction area)
- Placeholder text: "Start typing..." (gray)
- Below input: "Inspiration" link (small, unobtrusive)

**After clicking "Inspiration":**
- Input field remains at top
- Below input: 5 sentence fragment chips appear (pre-generated by agent)
- Below chips: "More Inspiration" link

**After clicking a chip:**
- Chip content appended to input field (with space separator if text already exists)
- "Continue typing" button appears (small link/button style)
- All other UI elements (chips, Inspiration link) become inactive/dimmed
- Only the input field and "Continue typing" button are active

**After clicking "Continue typing":**
- Cursor placed at end of input field
- "Continue typing" button disappears
- Chips become active again
- User can type freely or click another chip
- Continue button (to proceed to next step) becomes active since user has now "typed"

**Submit/Continue behavior:**
- Continue button (to proceed to next step) works like FO-04
- Becomes active when user has typed something (either directly or after clicking "Continue typing" following a chip selection)
- Just clicking a chip alone does NOT activate the Continue button - user must click "Continue typing" first

**After clicking "More Inspiration":**
- 8 additional pre-generated chips appear
- "More Inspiration" link disappears (one-time only, 13 total fragments max)
- All fragments are pre-generated upfront by the agent

**Chip styling:**
- Multi-line chips with wrapped text (fragments are longer than FO-04's single-word chips)

**Investigation rounds:**
- Same number of investigation steps as FO-04

### Agent Changes

The investigative agent must:
1. Receive both question and answer (not just answer) for better context
2. Generate varied reflective statements - the prompt should explicitly instruct the agent to seek variation and avoid repetitive openings like "It sounds like..."
3. Pre-generate 13 sentence fragment suggestions per question upfront (5 initial + 8 for "More Inspiration")

**Agent Response Structure:**
```typescript
interface DynamicScreenResponse {
  question: string;
  reflectiveStatement: string;
  initialFragments: string[];  // 5 sentence fragments
  expandedFragments: string[]; // 8 additional fragments for "More Inspiration"
}
```

### Required Screens

1. **Add FO-05 to existing Overview screen** - Add a card for FO-05 on the shared Overview screen
2. **Add FO-05 to left menu** - Add navigation entry in the left menu
3. **Info tab** - Information/help content for FO-05 (see below)
4. **Investigation screens** - The new UI described above
5. **Affirmation screen** - Final output (same pattern as FO-04)

### Overview Card Content

Add to `app/overview/page.tsx` versions array:
```typescript
{
  id: 'FO-05',
  name: 'Full Onboarding (Sentence Fragments)',
  href: '/fo-05',
  tagline: 'Lower friction with sentence starters',
  description: 'Same flow as FO-04 but with sentence fragment inspiration. Prominent text input with optional AI-generated half-finished sentences that help users get started writing.',
  inputType: 'Free text + sentence fragments',
  outputType: 'Iterative swipe selection',
  highlight: 'Sentence starters',
}
```

### Info Tab Content

The Info page should explain:
- The "sentence fragment" approach to lowering writing friction
- How "Inspiration" reveals AI-generated sentence starters
- That fragments append to existing text (users can combine multiple)
- The "Continue typing" flow after selecting a fragment
- Same overall process as FO-04, different input UX

## Implementation Notes

- This is an **independent implementation** with separate:
  - Agents (`src/mastra/agents/fo-05/`)
  - UI components (`components/fo-05/`)
  - Routes (`app/fo-05/`)
- Do not modify FO-04 code; create new files

## Testing

**End-to-end testing is required.** Create E2E tests that verify:
- The full flow from overview to affirmation
- Inspiration chip interaction (clicking shows 5 fragments)
- "More Inspiration" functionality (shows 8 more, then disappears)
- Sentence fragment appending behavior (with space separator)
- "Continue typing" button flow
- Info tab functionality

## Open Questions

None - all resolved.

## References

- FO-04 implementation: `app/fo-04/`, `src/mastra/agents/fo-04/`
- E2E testing docs: `docs/current/e2e-testing.md`
