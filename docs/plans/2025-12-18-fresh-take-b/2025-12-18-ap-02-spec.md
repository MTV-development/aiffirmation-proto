# Alternative Process 2 (AP-02) - "The Reactive Stream"

## Product Requirements Document

**Version:** 1.0
**Date:** 2025-12-18
**Based on:** Concept B from "Fresh Takes on Aiffirmations - UX Strategy Thoughts"

---

## Overview

Alternative Process 2 implements **Concept B: "The Reactive Stream"** - a zero-input, swipe-based affirmation discovery experience inspired by TikTok, Tinder, and Spotify.

### Core Concept

> "Zero Input → Behavioral Tuning"

The user receives affirmations immediately upon launch. No onboarding, no questions - just content. The AI learns preferences through swipe behavior.

### User Mental Model

**TikTok / Tinder / Spotify** - Endless discovery through simple gestures.

---

## Problem Statement

For the "Low Patience" user who is overwhelmed and experiences **Decision Fatigue**, even typing a single sentence can be a barrier. They can't articulate their needs - they just want relief.

### Key Insight

Value should be delivered in the first 0.1 seconds of app launch.

---

## User Flow

### Screen 1: The Zero-State Launch ("Today's Stream")

**Title:** "Today's Stream"

**Elements:**
- Dark mode UI (signals "Relaxation", reduces eye strain)
- Large swipeable card with affirmation text
- Purple/violet gradient card background
- Instruction hint: "Swipe left to pass · Swipe right to claim"
- Bottom bar with "Tune" and "Saved" icons

**UX Logic:**
- No onboarding. No questions. Just content.
- "Blue Ocean" approach - most affirmation apps force setup
- Instant dopamine hit with immediate value

**Card Styling:**
- Purple-to-violet gradient background
- Large, centered white text
- Rounded corners with slight shadow
- Tilts during swipe gesture

---

### Screen 2: Behavioral Training (Swipe Mechanic)

**Interactions:**
- **Swipe Left** = Pass/Skip (AI learns negatively)
- **Swipe Right** = Claim/Save (AI learns positively)
- Card tilts in swipe direction with visual feedback
- "Saved Successfully!" toast appears on right swipe

**Desktop/PC Controls:**
- **Arrow Left (←)** = Same as Swipe Left (Pass/Skip)
- **Arrow Right (→)** = Same as Swipe Right (Claim/Save)
- Small hint text at bottom: "Use ← → arrow keys on keyboard"

**UX Logic:**
- Swiping is lower-effort cognitive task than reading & selecting
- Algorithm trains itself in the background without surveys
- Each interaction feeds the personalization engine
- Keyboard controls ensure PC prototype usability

**Animation:**
- Card rotates slightly (5-10 degrees) during drag
- Opacity fades as card moves off-screen
- Next card slides up from behind
- Keyboard triggers same animation as swipe gesture

---

### Screen 3: Contextual Steering ("Tune" Bottom Sheet)

**Title:** "How's The Vibe"
**Subtitle:** "Too cheerful? Too serious? Help us adjust the stream for you right now."

**Options:**
- "Gentler & Calmer"
- "Stronger & Direct"
- "Change Topic entirely"

**UX Logic:**
- Safety valve for when pure algorithmic feels random
- Non-intrusive bottom sheet maintains immersive flow
- User agency without breaking the experience

---

### Screen 4: Saved Affirmations

**Header:** "Saved" with back navigation

**Elements:**
- List of saved affirmations in card format
- Same purple gradient styling as main cards
- Ability to remove saved items

---

## Technical Architecture

### New Agent: AP-02

The agent generates affirmations in a streaming/batch fashion for the "endless scroll" experience.

#### Capabilities:
1. **Initial batch generation** - Generate 10-15 diverse affirmations for cold start
2. **Personalized generation** - Generate new batches based on saved/skipped history
3. **Tone-adjusted generation** - Respond to "Tune" adjustments

### API Design

```typescript
interface AP02GenerateRequest {
  // For initial load - no history, triggers exploration mode
  isInitial?: boolean;
  // Tone adjustment from "Tune" feature
  tonePreference?: 'gentle' | 'strong' | 'change_topic';
  // Learning signals - used for personalization after exploration
  savedAffirmations?: string[];
  skippedAffirmations?: string[];
  // Avoid repeats
  shownAffirmations?: string[];
  // Total swipes so far - helps AI gauge confidence level
  totalSwipes?: number;
}

interface AP02GenerateResponse {
  affirmations: string[];  // Batch of 10-12 affirmations
}
```

**API Behavior:**
- `isInitial=true`: Generate diverse exploration batch (varied subjects, tones, lengths, structures)
- `totalSwipes < 10`: Light personalization, still include variety
- `totalSwipes >= 10`: Moderate to strong personalization based on save/skip patterns
- `tonePreference` set: Override and bias toward requested tone

### State Management

```typescript
type AP2Phase = 'stream' | 'tune' | 'saved';

interface AP2State {
  phase: AP2Phase;
  currentIndex: number;
  affirmationQueue: string[];      // Buffer of affirmations to show
  savedAffirmations: string[];     // User saved these (swipe right)
  skippedAffirmations: string[];   // User passed on these (swipe left)
  shownAffirmations: string[];     // All shown (for dedup)
  totalSwipes: number;             // Count of all swipes (for exploration->personalization transition)
  tonePreference: 'neutral' | 'gentle' | 'strong' | null;
  isLoading: boolean;
  error: string | null;
}
```

### Infinite Scroll Logic

1. **Initial Load**: Fetch 10-12 diverse exploration affirmations on mount
2. **Buffer Threshold**: When queue drops to 3 remaining, fetch more in background
3. **Learning Phases**:
   - **Swipes 0-10**: Exploration phase - AI generates diverse content to gather signal
   - **Swipes 10+**: Personalization phase - AI uses saved/skipped history to tune output
4. **Deduplication**: Track all shown affirmations to prevent repeats
5. **Feedback Passing**: Every fetch request includes full saved/skipped history + totalSwipes count

### File Structure

```
app/alt-process-2/
├── layout.tsx
├── page.tsx
└── actions.ts              # Server action for generate

components/alt-process-2/
├── index.ts
├── types.ts
├── storage.ts              # localStorage persistence
├── swipe-card.tsx          # Swipeable card component
├── card-stack.tsx          # Card stack with gesture handling
├── tune-sheet.tsx          # Bottom sheet for tuning
├── saved-screen.tsx        # Saved affirmations list
├── bottom-bar.tsx          # Tune + Saved navigation
└── ap2-experience.tsx      # Main orchestrator

src/mastra/agents/alt-process-2/
├── index.ts
└── agent.ts                # New AP-02 agent
```

---

## UI Specifications

### Color Palette (from mockups)

- **Background:** `#000000` (pure black)
- **Card Gradient:** `#8B5CF6` → `#6366F1` (purple to indigo)
- **Text:** `#FFFFFF` (white)
- **Bottom Bar Icons:** `#FFFFFF`
- **Hint Text:** `rgba(255,255,255,0.7)`

### Typography

- **Title ("Today's Stream"):** Medium weight, 18px, white
- **Affirmation Text:** Bold, 28-32px, white, centered
- **Hint Text:** Regular, 14px, semi-transparent white
- **Bottom Bar Labels:** Regular, 12px, white

### Animations

- **Card Swipe:** Spring physics with rotation (±15° max)
- **Card Exit:** Accelerate off-screen with fade
- **Card Enter:** Slide up from behind with scale (0.95 → 1.0)
- **Save Toast:** Fade in/out with slide up
- **Bottom Sheet:** Slide up with backdrop fade

### Gesture Thresholds

- **Swipe trigger:** 100px horizontal movement
- **Rotation factor:** 0.1 degrees per pixel
- **Velocity threshold:** 500px/s for quick flick

---

## Behavioral Learning Strategy

### Two-Phase Approach

The AI uses a deliberate two-phase strategy to learn user preferences:

#### Phase 1: Exploration (First ~10 Affirmations)

The initial batch of affirmations **intentionally explores the space** of subjects and tones to gather signal about user preferences. This batch should include:

**Subject Diversity:**
- Self-worth and acceptance
- Inner peace and calm
- Personal growth and learning
- Resilience and strength
- Trust and faith in self
- Gratitude and presence
- Boundaries and self-care
- Courage and action
- Relationships and connection
- Career and purpose

**Tone Diversity:**
- Gentle and nurturing ("I am learning to...")
- Assertive and direct ("I am worthy.")
- Growth-oriented ("I am becoming...")
- Action-focused ("I choose to...")
- Reflective ("My journey is...")

**Length Diversity:**
- Short (3-5 words): "I am enough."
- Medium (6-8 words): "I trust my own inner wisdom."
- Longer (9-12 words): "I am learning to embrace uncertainty as part of growth."

**Structure Diversity:**
- Simple identity: "I am..."
- Growth form: "I am learning to..."
- Action verb: "I choose...", "I allow..."
- Possessive: "My..."

This deliberate diversity ensures that user swipes provide **meaningful signal** about what resonates vs. what doesn't.

#### Phase 2: Personalization (After ~10 Swipes)

Once the system has collected ~10 swipe signals, subsequent batches should be **strongly informed** by observed preferences:

**From Saved Affirmations (Swipe Right):**
- Identify preferred tone (gentle vs. assertive)
- Note preferred length (short vs. detailed)
- Recognize resonant structures
- Extract themes that connect
- Generate MORE affirmations matching these patterns

**From Skipped Affirmations (Swipe Left):**
- Identify rejected patterns
- Note lengths that don't work
- Recognize structures that feel inauthentic
- Avoid similar tones
- Generate FEWER affirmations with these characteristics

**Confidence Scaling:**
- With 5-10 swipes: Light personalization, still exploring
- With 10-20 swipes: Moderate personalization, narrowing in
- With 20+ swipes: Strong personalization, confident in preferences

### Tune Adjustments

Manual overrides that take immediate effect:

- **"Gentler & Calmer"**: Shift toward soft, nurturing language
- **"Stronger & Direct"**: Shift toward assertive, action-oriented
- **"Change Topic"**: Reset theme context, generate fresh variety across new subjects

### What the AI Learns from Saves:
- Preferred tone (gentle vs. assertive)
- Preferred length (short vs. detailed)
- Preferred structure ("I am" vs. "I am learning")
- Themes that resonate

### What the AI Learns from Skips:
- Patterns to avoid
- Tones that don't connect
- Structures that feel inauthentic

---

## Success Metrics

1. **Session Duration** - Time spent swiping
2. **Save Rate** - % of affirmations saved vs. skipped
3. **Return Rate** - Users coming back for more streams
4. **Tune Usage** - How often users adjust the stream

---

## Out of Scope (v1)

- Audio/haptic feedback on swipe
- Share functionality
- Categories/topics selection
- User accounts / cloud sync
- Animations for card flip/3D effects

---

## Dependencies

- Existing Mastra AI framework
- Existing KV store for prompt templates
- Gesture library (react-use-gesture or framer-motion)

---

## References

- [UX Strategy PDF](./fresh%20takes%20on%20aiffirmations%20-%20ux%20strategy%20thoughts.pdf)
- [UI Mockups](./concept%20images.png) - Visual reference for all screens
- [AP-01 Implementation](../2025-12-17-fresh-take-a/) - Technical patterns to follow

---

## Appendix: UI Mockups

![Concept B Flow Mockups](./concept%20images.png)
